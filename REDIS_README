@@ -0,0 1,123 @@
PPoossttffiixx PPoossttggrreeSSQQLL HHoowwttoo

-------------------------------------------------------------------------------

IInnttrroodduuccttiioonn

The Postfix redis map type allows you to hook up Postfix to a Redis
database. 

BBuuiillddiinngg PPoossttffiixx wwiitthh PPoossttggrreeSSQQLL ssuuppppoorrtt

These instructions assume that you build Postfix from source code as described
in the INSTALL document. Some modification may be required if you build Postfix
from a vendor-specific source package.

In order to build Postfix with redis map support, you specify -DHAS_REDIS, the
directory with the hiredis header files, and the location of the hiredis
library file.

For example:

    % make tidy
    % make -f Makefile.init makefiles \
            'CCARGS=-DHAS_REDIS $(pkg-config --cflags hiredis)' \
            'AUXLIBS_REDIS=$(pkg-config --libs hiredis)'

Then just run 'make'.

CCoonnffiigguurriinngg PPoossttggrreeSSQQLL llooookkuupp ttaabblleess

Once Postfix is built with redis support, you can specify a map type in main.cf
like this:

    /etc/postfix/main.cf:
        virtual_mailbox_domains = redis:${config_directory}/redis-vdomains.cf

The file ${config_directory}/redis-vdomains.cf specifies the information telling
postfix how to connect to the redis database. It also has the prefix used to find
the required key. For a complete description, see
the redis_table(5) manual page.

EExxaammppllee:: llooccaall aalliiaasseess

#
# redis config file for virtual(8) lookups
#

#
# The hosts that Postfix will try to connect to
host = 127.0.0.1

# The prefix added to the query to check with redis
prefix = VDOM:

UUssiinngg mmiirrrroorreedd ddaattaabbaasseess

Sites that have a need for multiple mail exchangers can setup a redis cluster
if needed, for fallover capability.

CCrreeddiittss

  * This code is originaly by Titus T Jose.
  * It has been updated by Duncan Bellamy.
